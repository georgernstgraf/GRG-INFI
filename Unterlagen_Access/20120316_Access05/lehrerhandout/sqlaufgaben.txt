Abfragen mit OUTER JOIN mehrerer Tabellen
   
   
--Zeige Lehrernamen mit dem Text Ges_Lehrerlehrerin
--	(überlegen ob  inner, outer join)  --> ist ein inner join
SELECT L_Nr, L_Zuname, Ges_Lehrerlehrerin
FROM Geschlechter INNER JOIN Lehrer 
     ON Geschlechter.Ges_ID = Lehrer.L_Geschlecht
	--  outer join wäre hier gleich, weil es keine nicht vorkommenden Geschlechter gibt

--Welche Klassen haben keine Schüler   
SELECT S_Klasse, K_Nr
FROM Klassen LEFT JOIN Schueler ON Klassen.K_Nr = Schueler.S_Klasse
WHERE S_Klasse Is Null   

--Zeige alle Lehrer, gebe daneben aus ob sie Abteilungsleiter sind (Abt_Name angeben)
SELECT Lehrer.L_Nr, Lehrer.L_Zuname, Abteilungen.Abt_Name
FROM Lehrer LEFT JOIN Abteilungen ON Lehrer.L_Nr = Abteilungen.Abt_Leiter

--Welche Religionsbekenntnisse  sind nie bei Schülern eingetragen
SELECT Religionen.Rel_Nr, Religionen.Rel_Name, Schueler.S_Religion
FROM Religionen LEFT JOIN Schueler ON Religionen.Rel_ID = Schueler.S_Religion
WHERE S_Religion Is Null

--Welche Schüler haben kein Religionsbekenntnis
SELECT *
FROM Schueler
WHERE S_Religion Is Null    
	--   Fangfrage, hier ist gar kein Join notwendig, 
	--   alle nötige Info zur Fragestellung steht in einer Tabelle

------------------------------------------------
ändernde Abfragen

--Stelle das Feld S_Staatsbuergerschaft in Schueler auf österreichische Staatsbürgerschaft, 
--      falls es leer ist.
UPDATE Schueler 
SET Schueler.S_Staatsbuergerschaft = 1
WHERE S_Staatsbuergerschaft  Is Null

--Entferne aus der Tabelle Religionen den Eintrag für Rel_Name=„----Sonstige----“
DELETE Religionen.Rel_Name
FROM Religionen
WHERE Rel_Name = "----Sonstige----"

--Füge zur Tabelle Schueler ein Feld namens S_Alter hinzu 
--  und befülle es mit dem Alter in Tagen (Berechnung Tagesdatum – S_Gebdat)
UPDATE Schueler 
SET S_Alter = Now() - S_Gebdatum 


-- der folgende Befehl überträgt das Datumvon aus dem Schuljahr in die 
--    zugeordneten Klassen  (jeweils aus dem richtigen Schuljahr)
UPDATE Schuljahre INNER JOIN Klassen 
       ON Schuljahre.Sja_Nr = Klassen.K_Jahrsem 
SET Klassen.K_Datumvon = Sja_Datumvon
where Klassen.K_Datumvon IS NULL


-- Tabelle Katalog erzeugen
SELECT K_Nr AS Kat_Klasse, K_Jahrsem AS Kat_Jahrsem, S_Nr AS Kat_Schueler, False AS Kat_Abmeldung 
INTO Katalog
FROM Klassen INNER JOIN Schueler 
   ON Klassen.K_Nr = Schueler.S_Klasse
